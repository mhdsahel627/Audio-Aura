<!-- templates/invoices/invoice.html -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Invoice {{ order.order_number }}</title>
  <style>
    @page { size: A4; margin: 18mm 14mm; }
    body { font-family: -apple-system, Segoe UI, Roboto, Arial, sans-serif; font-size: 12px; color:#111; }
    .hdr{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px;}
    .brand h1{font-size:18px;margin:0;}
    .meta{font-size:12px;text-align:right;}
    .box{border:1px solid #e5e7eb;border-radius:8px;padding:10px;margin-bottom:10px;}
    .grid{display:flex;gap:12px;}
    .col{flex:1;}
    table{width:100%;border-collapse:collapse;margin-top:10px;}
    th,td{border-bottom:1px solid #e5e7eb;padding:8px;text-align:left;}
    th{background:#f8fafc;font-weight:700;}
    tfoot td{font-weight:700;}
    .right{text-align:right;}
    .muted{color:#6b7280;}
  </style>
</head>
<body>
  <div class="hdr">
    <div class="brand">
      <h1>Audio Aura</h1>
      <div class="muted">Invoice</div>
    </div>
    <div class="meta">
      <div><strong>No:</strong> {{ order.order_number }}</div>
    <div><strong>Date:</strong>
    {% if order.delivered_at %}
        {{ order.delivered_at|date:"d M Y" }}
    {% else %}
        {{ order.created_at|date:"d M Y" }}
    {% endif %}
    </div>

    </div>
  </div>

  <div class="grid">
    <div class="col box">
      <div><strong>Bill To</strong></div>
      <div>{{ order.ship_full_name }}</div>
      <div>{{ order.ship_line1 }}</div>
      {% if order.ship_line2 %}<div>{{ order.ship_line2 }}</div>{% endif %}
      <div>{{ order.ship_city }}, {{ order.ship_state }} {{ order.ship_postcode }}</div>
      <div>{{ order.ship_country }}</div>
      {% if order.ship_phone %}<div class="muted">{{ order.ship_phone }}</div>{% endif %}
    </div>
    <div class="col box">
      <div><strong>Payment</strong></div>
      <div>Method: {{ order.get_payment_method_display|default:order.payment_method }}</div>
      {% if order.paid_at %}<div>Paid at: {{ order.paid_at|date:"d M Y, H:i" }}</div>{% endif %}
      {% if order.coupon_code %}<div>Coupon: {{ order.coupon_code }} (-₹{{ order.coupon_discount }})</div>{% endif %}
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th>Product</th>
        <th class="right">Qty</th>
        <th class="right">Unit Price</th>
        <th class="right">Line Total</th>
      </tr>
    </thead>
    <tbody>
      {% for it in items %}
      <tr>
        <td>{{ it.product_name }}{% if it.variant_color %} ({{ it.variant_color }}){% endif %}</td>
        <td class="right">{{ it.quantity }}</td>
        <td class="right">RS.{{ it.unit_price }}</td>
        <td class="right">RS{{ it.line_total }}</td>
      </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr><td colspan="3" class="right">Subtotal</td><td class="right">RS{{ order.subtotal }}</td></tr>
      <tr><td colspan="3" class="right">Shipping</td><td class="right">RS{{ order.shipping_amount }}</td></tr>
      {% if order.discount_amount %}
      <tr><td colspan="3" class="right">Discounts</td><td class="right">−RS{{ order.discount_amount }}</td></tr>
      {% endif %}
      <tr><td colspan="3" class="right">Grand Total</td><td class="right">RS{{ order.total_amount }}</td></tr>
    </tfoot>
  </table>

  <p class="muted">Status: {{ order.status }}{% if delivered %} (Delivered){% endif %}</p>
</body>
</html>
