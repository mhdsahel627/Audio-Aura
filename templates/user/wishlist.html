{% extends "user/base.html" %}
{% load static %}
{% block title %}Wishlist{% endblock %}
{% block content %}
<style>
  .shell{max-width:1240px;margin:0 auto;padding:0 16px}
  .page-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;color:#fff;margin: 0px -89px 14px 306px;}
  .top-actions{display:flex;gap:10px}
  .pill{
    height: 40px;
    padding: 0 14px;
    border-radius: 7px;
    border: 1px solid #ffffff4d;
    background: #000000;
    color: #fff;
    font-weight: 900;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 6px;
  }

  .grid{display:grid;grid-template-columns:360px 1fr;gap:28px;align-items:start;margin: 0px -86px 0px -98px;}
  @media(max-width:1100px){.grid{grid-template-columns:1fr}}

  /* Framed inner panel with its own scroll (like ref) */
  .scroll{
    max-height:845px;
    width: 100%;
    overflow-y: scroll;
    border-radius:24px;padding:20px;background:#ffffff;
    box-shadow:inset 0 0 0 2px #E5E7EB;
  }
  .scroll::-webkit-scrollbar{width:8px}
  .scroll::-webkit-scrollbar-thumb{background:#9aa5b1;border-radius:999px}

  /* Card grid */
  .cards{display:grid;grid-template-columns:1fr 1fr;gap:55px}
  @media(max-width:900px){.cards{grid-template-columns:1fr}}

  /* Product card */
  .pc{
    background:#FAFAFA;border:2px solid #E5E7EB;border-radius:16px;
    box-shadow:0 8px 24px #000001;
    padding: 7px 12px 7px 7px;
    display:grid;grid-template-columns:150px 1fr;gap:44px;align-items:center;
    min-height:160px;
  }
  .pimg{position:relative;width:180px;height:211px;border-radius:10px;overflow:hidden;background:#120710}
  .pimg img{width:100%;height:178px;object-fit:cover;display:block}
  .pbadge{position:absolute;left:0;right:0;bottom:0;background:#ffc107;color:#2b1b00;font-size:11px;font-weight:800;line-height:1;padding:11px 8px;text-align:center}

  .ptitle{font-weight:900;font-size:18px;margin:0 0 25px;color:#0f1115}
  .prow{display:flex;align-items:center;gap:10px;margin:4px 0 6px}
  .price{font-weight:900}
  .mrp{opacity:.65;text-decoration:line-through}
  .off{color:#16a34a;font-weight:900}

  /* Spec chips row */
  .specs{display:flex;gap:6px;flex-wrap:wrap;margin:6px 0}
  .spec{
    font-size:10px;line-height:1;background:#eef2f7;color:#2a2f36;
    border:1px solid #e1e7ee;border-radius:999px;padding:4px 6px;font-weight:700
  }

  .ctas{margin-top:8px;display:flex;gap:6px;flex-wrap:wrap}
  .btn-sm{
    height:34px;width:220px;max-width:100%;
    padding:0 14px;border-radius:10px;border:1px solid #0f1115;
    background:#0f1115;color:#fff;font-weight:900
  }
  .btn-ghost{height:34px;padding:0 12px;border-radius:10px;border:1px solid #0f1115;background:#fff;color:#0f1115}
  /* Rating row above title */
.rating{
  display:flex;align-items:center;gap:6px;margin:0 0 6px;
  font-weight:800;color:#111
}
.star{color:#f59e0b;font-size:16px;line-height:1}        /* amber star */
.rating .score{font-size:14px}
.dot{width:4px;height:4px;background:#cbd5e1;border-radius:999px}
hr {
    margin: 0px 32px 0px 2px;
    color: black;
    opacity: 1.25;
}
</style>

<section style="padding:30px 0 54px;background:radial-gradient(1200px 700px at 15% -10%, rgba(255,255,255,.06), transparent),linear-gradient(180deg,#16031f,#2a0830)">
  <div class="shell">
    <div class="page-top">
      <div>WISHLIST <span style="opacity:.8">({{ wishlist_count|default:0 }})</span></div>
        <div class="top-actions">
          <form method="post" action="{% url 'wishlist:empty' %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="pill">Empty Wishlist</button>
          </form>
        </div>

    </div>

    <div class="grid">
      {% include "user/sidebar.html" with active_tab="wishlist" %}

      <div class="scroll">
        <div class="cards">

          {% for item in wishlist_items %}
            <article class="pc">
             <a href="{% url 'product_detail' item.variant.product.id %}" style="text-decoration:none;">
              <div class="pimg">
                {% if item.variant.primary_image_url %}
                  <img src="{{ item.variant.primary_image_url }}" alt="{{ item.variant }}">
                {% else %}
                  <img src="{% static 'images/no_image.jpg' %}" alt="No Image">
                {% endif %}
                <div class="pbadge">{{ item.variant.product.offer }}</div>
              </div>
            </a> 
              <div>
                <div class="rating">
                  <span class="star">★</span>
                  <span class="score">4.0</span>
                </div>
                <a href="{% url 'product_detail' item.variant.product.id %}" style="text-decoration:none;">
                <h3 class="ptitle">{{ item.variant.product.name }} <small>({{ item.variant.color }})</small></h3>
                </a>
                <div class="prow">
                  <div class="price">₹{{ item.variant.product.get_final_price|floatformat:0 }}</div>
                  <div class="mrp">₹{{ item.variant.product.base_price|floatformat:0 }}</div>
                  <div class="off">{{ item.variant.product.get_discount_percent }}% off</div>
                </div>
                <hr>
                <div class="ctas">
                  <!-- Add To Cart -->
                  <form method="post" action="{% url 'wishlist:add_item_to_cart' item.id %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn-sm">Add To Cart</button>
                  </form>

                  <!-- Remove from Wishlist -->
                  <form method="post" action="{% url 'wishlist:remove' item.id %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn-sm btn-ghost">Remove</button>
                  </form>
                </div>

              </div>
            </article>
          {% empty %}
          <div class="wish-empty">
            <div class="wish-gridd">
              <img  class="wish-img1" src="https://res.cloudinary.com/dxndvadjt/image/upload/v1765252804/84-848019_empty-pockets-cartoon-hd-png-download-removebg-preview_zlof26.png" alt=""> 
              <img  class="wish-img2" src="https://res.cloudinary.com/dxndvadjt/image/upload/v1765252769/wishlist_rdqt2t.jpg" alt=""> 
            </div>
            
            <h2 >Your wishlist is empty.</h2>
            <p>Explore our wide selection and find something you like.</p>
            <a href="{% url 'shop' %}">Start shopping</a>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</section>
<style>
  
  .wish-gridd{
    display: flex;
    justify-content: space-between;
    flex-direction: row;
  }

  .wish-empty{
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    margin: 0px 0px 0px 115px;
  }
  .wish-img1{
    height: 341px;
    width: 317px;
  }
  .wish-img2{
    height: 270px;
    width: 317px;
  }
  .wish-empty h2{
    color: #000000;
    margin: 18px 0 8px;
    font-size: 24px;
    font-weight: 800;
  }
  .wish-empty p {
    color: #0000008c;
    margin: 0 0 18px;
    font-weight: 600;
  }
  .wish-empty a{
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 44px;
    padding: 0 18px;
    border-radius: 12px;
    background: #000;
    color: #fff;
    font-weight: 700;
    border: 1px solid #3c3140;
    text-decoration: none;
  }

</style>
{% endblock %}
