{% extends 'admin/admin-base.html' %}
{% load static %}

{% block title %}Add Banner{% endblock %}

{% block content %}
<style>
.add-page {
  min-height: 100%;
  background: radial-gradient(1200px 600px at 20% -10%, #4c0d3c 0%, #1a0820 60%, #0f0714 100%);
  padding: 32px 16px 64px;
  color: #fff;
}
.add-card {
  max-width: 980px;
  margin: 0 auto;
  background: #fff;
  color: #111;
  border-radius: 18px;
  box-shadow: 0 6px 24px rgba(0,0,0,.35);
  padding: 22px;
}
.add-title {
  text-align: center;
  font-weight: 800;
  letter-spacing: .5px;
  margin-bottom: 12px;
}

/* Title input */
.label { font-weight: 700; margin: 6px 0 8px; }
.input {
  width: 100%; height: 44px; border-radius: 10px; border: 1px solid #151515;
  background: #0f0f10; color: #f5f5f5; padding: 0 14px; outline: none;
}

/* Dropzone */
.drop {
  margin-top: 14px;
  border: 2px dashed #e8e8ef; border-radius: 12px;
  background: #fafbff;
  display: grid; place-items: center;
  padding: 36px 14px; text-align: center; color: #6b7280;
}
.drop .ico {
  width: 123px;
  height: 64px;
  border-radius: 12px;
  display: grid; place-items: center;
  background: #eef; color: #5a5ad7; margin-bottom: 10px;
}
.drop .btn {
  margin-top: 10px; background: #e9e9ff; color: #3730a3; border: none;
  padding: 8px 14px; border-radius: 8px; cursor: pointer;
}
.preview {
  margin-top: 12px; display: none;
}
.preview img { max-width: 100%; border-radius: 12px; }

/* Footer fields row */
.row { display: flex; gap: 18px; flex-wrap: wrap; margin-top: 16px; }
.group { flex: 1 1 260px; background: #fff; border: 1px solid #efefef; border-radius: 12px; padding: 10px 12px; box-shadow: 0 1px 0 #f3f3f3; }
.group .glab { font-weight: 800; background:#0f0f10; color:#fff; display:inline-block; padding:6px 12px; border-radius:8px; margin-bottom:8px; }
.group input[type=date] {
  width: 100%; height: 40px; border-radius: 10px; border: 1px solid #ddd; padding: 0 12px;
}

/* Add button */
.submit-wrap { display:flex; justify-content:center; margin-top: 26px; }
.submit {
  background:#0f0f10; color:#fff; border:none; padding:14px 36px; border-radius:10px; font-weight:800; letter-spacing:.5px; cursor:pointer;
}
.submit:hover { filter: brightness(1.1); }
.grp{
    display:flex ;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
</style>

<div class="add-page">
  <form method="post" enctype="multipart/form-data" class="add-card" id="bannerForm">
    {% csrf_token %}
    <h2 class="add-title">ADD NEW BANNER</h2>

    <label class="label">Banners Title</label>
    <input class="input" name="title" type="text" placeholder="boAt" required>

    <!-- Dropzone -->
    <div class="drop" id="dropzone">
      <div class="grp">
        <div class="ico"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-images" viewBox="0 0 16 16">
  <path d="M4.502 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3"/>
  <path d="M14.002 13a2 2 0 0 1-2 2h-10a2 2 0 0 1-2-2V5A2 2 0 0 1 2 3a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v8a2 2 0 0 1-1.998 2M14 2H4a1 1 0 0 0-1 1h9.002a2 2 0 0 1 2 2v7A1 1 0 0 0 15 11V3a1 1 0 0 0-1-1M2.002 4a1 1 0 0 0-1 1v8l2.646-2.354a.5.5 0 0 1 .63-.062l2.66 1.773 3.71-3.71a.5.5 0 0 1 .577-.094l1.777 1.947V5a1 1 0 0 0-1-1z"/>
</svg></div>
        <div>Drag and drop image here, or click add image</div>
        <button class="btn" type="button" id="chooseBtn">Add Image</button>
      </div>
      <input type="file" name="image" id="fileInput" accept="image/*" hidden>
    </div>
    <div class="preview" id="preview">
      <img id="previewImg" alt="preview">
    </div>

    <div class="row">
      <div class="group">
        <span class="glab">Status</span>
        <div><span id="daysLeft">—</span> days left</div>
      </div>
      <div class="group">
        <span class="glab">Starting Date</span>
        <input type="date" name="start_date" id="startDate" required>
      </div>
      <div class="group">
        <span class="glab">End Date</span>
        <input type="date" name="end_date" id="endDate" required>
      </div>
    </div>

    <div class="submit-wrap">
      <button class="submit" type="submit">ADD</button>
    </div>
  </form>
</div>

<script>
(function(){
  const dz = document.getElementById('dropzone');
  const fi = document.getElementById('fileInput');
  const chooseBtn = document.getElementById('chooseBtn');
  const preview = document.getElementById('preview');
  const previewImg = document.getElementById('previewImg');
  const startDate = document.getElementById('startDate');
  const endDate = document.getElementById('endDate');
  const daysLeft = document.getElementById('daysLeft');

  chooseBtn.addEventListener('click', ()=> fi.click());
  dz.addEventListener('click', ()=> fi.click());

  ['dragenter','dragover'].forEach(evt=>dz.addEventListener(evt, e=>{e.preventDefault(); dz.style.background='#f2f5ff';}));
  ['dragleave','drop'].forEach(evt=>dz.addEventListener(evt, e=>{e.preventDefault(); dz.style.background='#fafbff';}));
  dz.addEventListener('drop', e=>{
    e.preventDefault();
    if (e.dataTransfer.files && e.dataTransfer.files[0]) {
      fi.files = e.dataTransfer.files;
      showPreview();
    }
  });
  fi.addEventListener('change', showPreview);
  function showPreview(){
    const f = fi.files[0];
    if (!f) return;
    const url = URL.createObjectURL(f);
    previewImg.src = url;
    preview.style.display = 'block';
  }

  function calcDays(){
    if (!endDate.value) { daysLeft.textContent = '—'; return; }
    const end = new Date(endDate.value);
    const today = new Date();
    const ms = end.setHours(0,0,0,0) - today.setHours(0,0,0,0);
    const d = Math.ceil(ms / (1000*60*60*24));
    daysLeft.textContent = isFinite(d) ? Math.max(d,0) : '—';
  }
  startDate.addEventListener('change', calcDays);
  endDate.addEventListener('change', calcDays);
})();
</script>
{% endblock %}
