{% extends 'admin/admin-base.html' %}
{% load static %}

{% block title %}Category-add{% endblock %}

{% block content %}

<style>
  .form-section {
    background: #000;
    padding: 2rem;
    border-radius: 12px;
  }
  .image-upload {
    border: 2px dashed #666;
    border-radius: 8px;
    padding: 40px 20px;
    text-align: center;
    background: #1e1e1e;
    cursor: pointer;
    transition: border 0.3s;
  }
  .image-upload:hover {
    border-color: #8855ff;
  }
  .btn-submit {
    background: #7c5c5c;
    color: #fff;
  }
  .btn-submit:hover {
    background: #5a4141;
  }

  .image-upload.highlight {
  border-color: #8855ff;
  background: #2a2a2a;
}

</style>

<div class="container py-5">
  <h2 class="fw-bold mb-4">ADD A CATEGORY</h2>

  <!-- Make sure to include method="POST" and csrf token -->
  <form class="form-section" method="POST" enctype="multipart/form-data">
    {% csrf_token %}

    <!-- Header Image -->
    <div class="mb-4">
      <label class="form-label">Header Image</label>
      <input type="file" name="image" class="form-control mb-2", required>
      <div class="image-upload">
        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#9c8df0" stroke="#9c8df0" class="bi bi-image" viewBox="0 0 16 16">
          <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"/>
          <path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1z"/>
        </svg>
        <p>Drag and drop image here, or click add image</p>
      </div>
    </div>

    <!-- Category Name -->
    <div class="mb-4">
      <label for="categoryName" class="form-label">Category Name</label>
      <input type="text" id="categoryName" name="name" class="form-control" placeholder="Type category name here..." required>
    </div>

    <!-- Description -->
    <div class="mb-4">
      <label for="description" class="form-label">Description</label>
      <textarea id="description" name="description" class="form-control" rows="4" placeholder="Type category description here..."></textarea>
    </div>

    <!-- Buttons -->
    <div class="d-flex flex-wrap gap-3 justify-content-end">
      <a href="{% url 'catogery' %}" class="btn btn-light">Cancel</a>
      <button type="submit" class="btn btn-submit">Add Category</button>
    </div>
  </form>
</div>

<script>
  let dropArea = document.querySelector(".image-upload");
  let fileInput = document.querySelector("input[name='image']");

  // Click drop area = open file dialog
  dropArea.addEventListener("click", () => fileInput.click());

  // Prevent default browser behavior
  ["dragenter", "dragover", "dragleave", "drop"].forEach(eventName => {
    dropArea.addEventListener(eventName, e => {
      e.preventDefault();
      e.stopPropagation();
    });
  });

  // Highlight drag area
  ["dragenter", "dragover"].forEach(eventName => {
    dropArea.addEventListener(eventName, () => dropArea.classList.add("highlight"));
  });
  ["dragleave", "drop"].forEach(eventName => {
    dropArea.addEventListener(eventName, () => dropArea.classList.remove("highlight"));
  });

  // Handle dropped file
  dropArea.addEventListener("drop", e => {
    let files = e.dataTransfer.files;
    fileInput.files = files; // attach to real input
    previewFile(files[0]);
  });

  // Preview
  function previewFile(file) {
    let reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onloadend = () => {
      dropArea.innerHTML = `<img src="${reader.result}" class="img-fluid rounded" width="200">`;
    };
  }
</script>


{% endblock %}
